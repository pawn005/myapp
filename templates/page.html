<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <title>{{ "%03d"|format(page_id) }}</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='style.css') }}"
    />
    <style>
      /* 円周率アニメーション専用 */
      #piCanvas {
        display: block;
        margin: 0 auto;
        background: black;
      }
    </style>
  </head>
  <body>
    <div class="header">
      <span id="backBtn">BACK</span>
      <span class="page-id">{{ "%03d"|format(page_id) }}</span>
    </div>

    <div class="content">
      {% if page_id == 0 %}
      <canvas id="piCanvas"></canvas>
      {% else %}
      <h2>ここに Page {{ "%03d"|format(page_id) }} の内容を追加</h2>
      {% endif %}
    </div>

    <script>
      document.getElementById("backBtn").addEventListener("click", function() {
        window.location.href = "{{ url_for('index') }}";
      });

      {% if page_id == 0 %}
        const canvas = document.getElementById("piCanvas");
        const ctx = canvas.getContext("2d");
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const centerX = canvas.width / 2;
        const centerY = canvas.height / 2;
        let step = 0;

        // πの小数部分（最初の50桁）
        const pi_digits = "14159265358979323846264338327950288419716939937510";

        function drawNext() {
            if (step >= pi_digits.length) return;

            const digit = parseInt(pi_digits[step]);
            const angle = digit * 36 * Math.PI / 180;
            const length = 10 + step * 0.5;

            const x = centerX + length * Math.cos(angle);
            const y = centerY + length * Math.sin(angle);

            ctx.strokeStyle = "white";
            ctx.beginPath();
            ctx.moveTo(centerX, centerY);
            ctx.lineTo(x, y);
            ctx.stroke();

            step++;
            requestAnimationFrame(drawNext);
        }

        drawNext();
      {% endif %}
    </script>
  </body>
</html>
