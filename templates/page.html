<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>{{ "%03d"|format(page_id) }}</title>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background-color: black;
      color: white;
    }
    .header {
      display: flex;
      align-items: center;
      padding: 10px;
      font-size: 1.2em;
      cursor: pointer;
    }
    #backBtn {
      color: white;
      margin-right: 10px;
    }
    #piCanvas {
      display: block;
      margin: 0 auto;
      background-color: black;
    }
  </style>
</head>
<body>
  <div class="header">
    <span id="backBtn">BACK</span>
    <span class="page-id">{{ "%03d"|format(page_id) }}</span>
  </div>

  <canvas id="piCanvas"></canvas>

  <script>
    document.getElementById("backBtn").addEventListener("click", function() {
      window.location.href = "{{ url_for('index') }}";
    });

    const canvas = document.getElementById("piCanvas");
    const ctx = canvas.getContext("2d");
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    {% if page_id == 0 %}
      // 000ページ: 円周率アニメ
      const centerX = canvas.width / 2;
      const centerY = canvas.height / 2;
      let step = 0;
      const pi_digits = "14159265358979323846264338327950288419716939937510";

      function drawPi() {
        ctx.fillStyle = "rgba(0,0,0,0.1)";
        ctx.fillRect(0,0,canvas.width,canvas.height);

        const digit = parseInt(pi_digits[step]);
        const angle = digit * 36 * Math.PI / 180;
        const length = 200;

        const x = centerX + length * Math.cos(angle);
        const y = centerY + length * Math.sin(angle);

        ctx.strokeStyle = "white";
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.moveTo(centerX, centerY);
        ctx.lineTo(x, y);
        ctx.stroke();

        step = (step + 1) % pi_digits.length;
        requestAnimationFrame(drawPi);
      }

      drawPi();

    {% elif page_id == 1 %}
      // 001ページ: 模倣表示（単純な色ブロック）
      const blockSize = 50;
      let frame = 0;

      function drawMock() {
        ctx.fillStyle = "rgba(0,0,0,0.2)";
        ctx.fillRect(0,0,canvas.width,canvas.height);

        const cols = Math.floor(canvas.width / blockSize);
        const rows = Math.floor(canvas.height / blockSize);

        for (let r = 0; r < rows; r++) {
          for (let c = 0; c < cols; c++) {
            const hue = (frame + r*20 + c*10) % 360;
            ctx.fillStyle = `hsl(${hue}, 80%, 60%)`;
            ctx.fillRect(c*blockSize, r*blockSize, blockSize-2, blockSize-2);
          }
        }

        frame += 2;
        requestAnimationFrame(drawMock);
      }

      drawMock();
    {% endif %}
  </script>
</body>
</html>